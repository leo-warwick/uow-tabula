/*
 Copyright (c) 2007 Christian Bach
    Dual licensed under the MIT and GPL licenses:
    http://www.opensource.org/licenses/mit-license.php
    http://www.gnu.org/licenses/gpl.html
*/
(function(c){c.extend({tablesorter:new function(){function a(b,a){n(b+","+((new Date).getTime()-a.getTime())+"ms")}function n(b){"undefined"!=typeof console&&"undefined"!=typeof console.debug?console.log(b):alert(b)}function l(b,a){if(b.config.debug)var d="";if(0!=b.tBodies.length){var h=b.tBodies[0].rows;if(h[0])for(var e=[],g=h[0].cells.length,i=0;i<g;i++){var f=!1;c.metadata&&c(a[i]).metadata()&&c(a[i]).metadata().sorter?f=t(c(a[i]).metadata().sorter):b.config.headers[i]&&b.config.headers[i].sorter&&
(f=t(b.config.headers[i].sorter));if(!f)a:{for(var f=b,k=h,m=-1,J=i,y=o.length,p=!1,q=!1,r=!0;""==q&&r;)m++,k[m]?(p=k[m].cells[J],q=c.trim(z(f.config,p)),f.config.debug&&n("Checking if value was empty on row:"+m)):r=!1;for(k=1;k<y;k++)if(o[k].is(q,f,p)){f=o[k];break a}f=o[0]}b.config.debug&&(d+="column:"+i+" parser:"+f.id+"\n");e.push(f)}b.config.debug&&n(d);return e}}function t(b){for(var a=o.length,d=0;d<a;d++)if(o[d].id.toLowerCase()==b.toLowerCase())return o[d];return!1}function v(b){if(b.config.debug)var j=
new Date;for(var d=b.tBodies[0]&&b.tBodies[0].rows.length||0,h=b.tBodies[0].rows[0]&&b.tBodies[0].rows[0].cells.length||0,e=b.config.parsers,g={row:[],normalized:[]},i=0;i<d;++i){var f=c(b.tBodies[0].rows[i]),k=[];if(f.hasClass(b.config.cssChildRow))g.row[g.row.length-1]=g.row[g.row.length-1].add(f);else{g.row.push(f);for(var m=0;m<h;++m)k.push(e[m].format(z(b.config,f[0].cells[m]),b,f[0].cells[m]));k.push(g.normalized.length);g.normalized.push(k)}}b.config.debug&&a("Building cache for "+d+" rows:",
j);return g}function z(b,a){var d="";if(!a)return"";b.supportsTextContent||(b.supportsTextContent=a.textContent||!1);return d="simple"==b.textExtraction?b.supportsTextContent?a.textContent:a.childNodes[0]&&a.childNodes[0].hasChildNodes()?a.childNodes[0].innerHTML:a.innerHTML:"function"==typeof b.textExtraction?b.textExtraction(a):c(a).text()}function A(b,j){if(b.config.debug)var d=new Date;for(var h=j.row,e=j.normalized,g=e.length,i=e[0].length-1,f=c(b.tBodies[0]),k=[],m=0;m<g;m++){var n=e[m][i];
k.push(h[n]);if(!b.config.appender)for(var l=h[n].length,p=0;p<l;p++)f[0].appendChild(h[n][p])}b.config.appender&&b.config.appender(b,k);k=null;b.config.debug&&a("Rebuilt table:",d);B(b);setTimeout(function(){c(b).trigger("sortEnd")},0)}function D(b,a){return b.config.headers[a]&&b.config.headers[a].lockedOrder?b.config.headers[a].lockedOrder:!1}function B(b){for(var a=b.config.widgets,d=a.length,c=0;c<d;c++)E(a[c]).format(b)}function E(b){for(var a=u.length,d=0;d<a;d++)if(u[d].id.toLowerCase()==
b.toLowerCase())return u[d]}function F(a,j,d,h){j.removeClass(h[0]).removeClass(h[1]);var e=[];j.each(function(){this.sortDisabled||(e[this.column]=c(this))});a=d.length;for(j=0;j<a;j++)e[d[j][0]].addClass(h[d[j][1]])}function G(b,c,d){if(b.config.debug)var h=new Date;for(var e="var sortWrapper = function(a,b) {",g=c.length,i=0;i<g;i++)var f=c[i][0],k=c[i][1],f="text"==b.config.parsers[f].type?0==k?w("text","asc",f):w("text","desc",f):0==k?w("numeric","asc",f):w("numeric","desc",f),m="e"+i,e=e+("var "+
m+" = "+f),e=e+("if("+m+") { return "+m+"; } "),e=e+"else { ";i=d.normalized[0].length-1;e+="return a["+i+"]-b["+i+"];";for(i=0;i<g;i++)e+="}; ";e+="return 0; }; ";b.config.debug&&a("Evaling expression:"+e,new Date);eval(e);d.normalized.sort(sortWrapper);b.config.debug&&a("Sorting on "+c.toString()+" and dir "+k+" time:",h);return d}function w(a,c,d){var h="a["+d+"]",d="b["+d+"]";if("text"==a&&"asc"==c)return"("+h+" == "+d+" ? 0 : ("+h+" === null ? Number.POSITIVE_INFINITY : ("+d+" === null ? Number.NEGATIVE_INFINITY : ("+
h+" < "+d+") ? -1 : 1 )));";if("text"==a&&"desc"==c)return"("+h+" == "+d+" ? 0 : ("+h+" === null ? Number.POSITIVE_INFINITY : ("+d+" === null ? Number.NEGATIVE_INFINITY : ("+d+" < "+h+") ? -1 : 1 )));";if("numeric"==a&&"asc"==c)return"("+h+" === null && "+d+" === null) ? 0 :("+h+" === null ? Number.POSITIVE_INFINITY : ("+d+" === null ? Number.NEGATIVE_INFINITY : "+h+" - "+d+"));";if("numeric"==a&&"desc"==c)return"("+h+" === null && "+d+" === null) ? 0 :("+h+" === null ? Number.POSITIVE_INFINITY : ("+
d+" === null ? Number.NEGATIVE_INFINITY : "+d+" - "+h+"));"}var o=[],u=[];this.defaults={cssTable:"tablesorter",cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",cssChildRow:"expand-child",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,sortLocaleCompare:!0,textExtraction:"simple",parsers:{},widgets:[],headers:{},widthFixed:!1,cancelSelection:!0,sortList:[],headerList:[],dateFormat:"us",decimal:"/.|,/g",onRenderHeader:null,selectorHeaders:"thead th",
debug:!1};this.benchmark=a;this.construct=function(b){return this.each(function(){if(this.tHead&&this.tBodies){var j,d,h,e;this.config={};e=c.extend(this.config,c.tablesorter.defaults,b);j=c(this);c.data(this,"tablesorter",e);var g=this;if(g.config.debug)var i=new Date;for(var f=[],k={},m=g.getElementsByTagName("THEAD")[0].getElementsByTagName("TR"),o=0;o<m.length;o++)for(var t=m[o].cells,p=0;p<t.length;p++){var q=t[p],r=q.parentNode.rowIndex,u=r+"-"+q.cellIndex,w=q.rowSpan||1,q=q.colSpan||1,x;"undefined"==
typeof f[r]&&(f[r]=[]);for(var s=0;s<f[r].length+1;s++)if("undefined"==typeof f[r][s]){x=s;break}k[u]=x;for(s=r;s<r+w;s++){"undefined"==typeof f[s]&&(f[s]=[]);for(var u=f[s],C=x;C<x+q;C++)u[C]="x"}}$tableHeaders=c(g.config.selectorHeaders,g).each(function(a){this.column=k[this.parentNode.rowIndex+"-"+this.cellIndex];this.count=this.order="Number"!=typeof g.config.sortInitialOrder?"desc"==g.config.sortInitialOrder.toLowerCase()?1:0:1==g.config.sortInitialOrder?1:0;if(c.metadata&&!1===c(this).metadata().sorter||
g.config.headers[a]&&!1===g.config.headers[a].sorter)this.sortDisabled=!0;D(g,a)&&(this.order=this.lockedOrder=D(g,a));if(!this.sortDisabled){var b=c(this).addClass(g.config.cssHeader);g.config.onRenderHeader&&g.config.onRenderHeader.apply(b)}g.config.headerList[a]=this});g.config.debug&&(a("Built headers:",i),n($tableHeaders));d=$tableHeaders;this.config.parsers=l(this,d);h=v(this);var H=[e.cssDesc,e.cssAsc];if(this.config.widthFixed){var I=c("<colgroup>");c("tr:first td",this.tBodies[0]).each(function(){I.append(c("<col>").css("width",
c(this).width()))});c(this).prepend(I)}c(this).addClass(e.cssTable);d.click(function(a){var b=j[0].tBodies[0]&&j[0].tBodies[0].rows.length||0;if(!this.sortDisabled&&b>0){j.trigger("sortStart");c(this);b=this.column;this.order=this.count++%2;if(this.lockedOrder)this.order=this.lockedOrder;if(a[e.sortMultiSortKey]){a:{for(var a=e.sortList,f=a.length,g=0;g<f;g++)if(a[g][0]==b){a=true;break a}a=false}if(a)for(a=0;a<e.sortList.length;a++){f=e.sortList[a];g=e.headerList[f[0]];if(f[0]==b){g.count=f[1];g.count++;
f[1]=g.count%2}}else e.sortList.push([b,this.order])}else{e.sortList=[];e.sortList.push([b,this.order]);if(e.sortForce!=null){f=e.sortForce;for(a=0;a<f.length;a++)f[a][0]!=b&&e.sortList.push(f[a])}}setTimeout(function(){F(j[0],d,e.sortList,H);A(j[0],G(j[0],e.sortList,h))},1);return false}}).mousedown(function(){if(e.cancelSelection){this.onselectstart=function(){return false};return false}});j.bind("update",function(){var a=this;setTimeout(function(){a.config.parsers=l(a,d);h=v(a)},1)}).bind("updateCell",
function(a,b){var c=this.config,d=[b.parentNode.rowIndex-1,b.cellIndex];h.normalized[d[0]][d[1]]=c.parsers[d[1]].format(z(c,b),b)}).bind("sorton",function(a,b){c(this).trigger("sortStart");e.sortList=b;for(var f=e.sortList,g=this.config,i=f.length,j=0;j<i;j++){var k=f[j],m=g.headerList[k[0]];m.count=k[1];m.count++}F(this,d,f,H);A(this,G(this,f,h))}).bind("appendCache",function(){A(this,h)}).bind("applyWidgetId",function(a,b){E(b).format(this)}).bind("applyWidgets",function(){B(this)});c.metadata&&
(c(this).metadata()&&c(this).metadata().sortlist)&&(e.sortList=c(this).metadata().sortlist);0<e.sortList.length&&j.trigger("sorton",[e.sortList]);B(this)}})};this.addParser=function(a){for(var c=o.length,d=!0,h=0;h<c;h++)o[h].id.toLowerCase()==a.id.toLowerCase()&&(d=!1);d&&o.push(a)};this.addWidget=function(a){u.push(a)};this.formatFloat=function(a){a=parseFloat(a);return isNaN(a)?0:a};this.formatInt=function(a){a=parseInt(a);return isNaN(a)?0:a};this.isDigit=function(a){return/^[-+]?\d*$/.test(c.trim(a.replace(/[,.']/g,
"")))};this.clearTableBody=function(a){c.browser.msie?function(){for(;this.firstChild;)this.removeChild(this.firstChild)}.apply(a.tBodies[0]):a.tBodies[0].innerHTML=""}}});c.fn.extend({tablesorter:c.tablesorter.construct});var l=c.tablesorter;l.addParser({id:"text",is:function(){return!0},format:function(a){return c.trim(a.toLocaleLowerCase())},type:"text"});l.addParser({id:"digit",is:function(a,n){return c.tablesorter.isDigit(a,n.config)},format:function(a){return c.tablesorter.formatFloat(a)},type:"numeric"});
l.addParser({id:"currency",is:function(a){return/^[\u00a3$\u20ac?.]/.test(a)},format:function(a){return c.tablesorter.formatFloat(a.replace(RegExp(/[\u00a3$\u20ac]/g),""))},type:"numeric"});l.addParser({id:"ipAddress",is:function(a){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(a)},format:function(a){for(var a=a.split("."),n="",l=a.length,t=0;t<l;t++)var v=a[t],n=2==v.length?n+("0"+v):n+v;return c.tablesorter.formatFloat(n)},type:"numeric"});l.addParser({id:"url",is:function(a){return/^(https?|ftp|file):\/\/$/.test(a)},
format:function(a){return jQuery.trim(a.replace(RegExp(/(https?|ftp|file):\/\//),""))},type:"text"});l.addParser({id:"isoDate",is:function(a){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(a)},format:function(a){return c.tablesorter.formatFloat(""!=a?(new Date(a.replace(RegExp(/-/g),"/"))).getTime():"0")},type:"numeric"});l.addParser({id:"percent",is:function(a){return/\%$/.test(c.trim(a))},format:function(a){return c.tablesorter.formatFloat(a.replace(RegExp(/%/g),""))},type:"numeric"});l.addParser({id:"usLongDate",
is:function(a){return a.match(RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/))},format:function(a){return c.tablesorter.formatFloat((new Date(a)).getTime())},type:"numeric"});l.addParser({id:"shortDate",is:function(a){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(a)},format:function(a,n){var l=n.config,a=a.replace(/\-/g,"/");if("us"==l.dateFormat)a=a.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2");else if("uk"==
l.dateFormat)a=a.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1");else if("dd/mm/yy"==l.dateFormat||"dd-mm-yy"==l.dateFormat)a=a.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3");return c.tablesorter.formatFloat((new Date(a)).getTime())},type:"numeric"});l.addParser({id:"time",is:function(a){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(a)},format:function(a){return c.tablesorter.formatFloat((new Date("2000/01/01 "+a)).getTime())},type:"numeric"});
l.addParser({id:"metadata",is:function(){return!1},format:function(a,l,y){a=l.config;a=!a.parserMetadataName?"sortValue":a.parserMetadataName;return c(y).metadata()[a]},type:"numeric"})})(jQuery);

